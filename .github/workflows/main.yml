name: Simulate Google Play Redeem Code Purchase and Redemption

on:
  workflow_dispatch:  # Allows manual trigger

jobs:
  redeem_code_simulation:
    runs-on: ubuntu-latest

    steps:
    - name: Start Redeem Code Purchase Process
      run: echo "Initiating purchase of $10 Google Play gift card redeem code..."

    - name: Simulate Purchase Delay (up to 10 minutes)
      run: |
        echo "Simulating purchase delay (shortened to 30 seconds for demo)..."
        sleep 30
        echo "Purchase successfully completed."

    - name: Generate 16-Digit Google Play Redeem Code
      id: generate_code
      run: |
        CODE=$(head /dev/urandom | tr -dc A-Z0-9 | head -c16)
        echo "Generated Redeem Code: $CODE"
        echo "::set-output name=redeem_code::$CODE"

    - name: Verify Payment
      run: |
        echo "Verifying payment for redeem code..."
        sleep 5
        echo "Payment verified successfully."

    - name: Redeem Code within 40 Seconds
      run: |
        echo "Redeeming code ${{ steps.generate_code.outputs.redeem_code }} within 40 seconds..."
        sleep 40
        echo "Redeem code redeemed successfully."

    - name: Complete Process
      run: echo "Google Play redeem code process completed successfully."
